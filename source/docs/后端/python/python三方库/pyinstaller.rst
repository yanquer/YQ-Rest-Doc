=======================================
pyinstaller
=======================================


.. post:: 2024-02-21 21:55:17
  :tags: python, python三方库
  :category: 后端
  :author: YanQue
  :location: CD
  :language: zh-cn


python打包程序

安装::

  pip install pyinstaller

使用 :doc:`/docs/后端/python/python三方库/py2app` 在哪个平台打包就生成哪种文件

与py2app结合使用(MacOS)
=======================================s

安装好pyinstaller和py2app后, cd进去项目目录

我的目录结构::

  .
  ├── img
  │   ├── img.png
  │   ├── img_1.png
  │   └── img_2.png
  └── t_sheep.py

生成setup文件 会自动识别资源文件跟图标的(mac会)::

  py2applet --make-setup t_sheep.py img logo.icns

目录::

  ├── img
  │   ├── img.png
  │   ├── img_1.png
  │   └── img_2.png
  ├── setup.py 		# 这个就是生成的
  └── t_sheep.py

打包::

  python3 setup.py py2app

目录::

  .
  ├── build
  │   └── bdist.macosx-12-x86_64
  ├── dist
  │   └── t_sheep.app 	# 这个就是mac下的应用程序,
  ├── img
  │   ├── img.png
  │   ├── img_1.png
  │   └── img_2.png
  ├── setup.py
  └── t_sheep.py


完成后会在当前目录下的dist目录下有应用,

注意 setup 的资源配置::

  """
  This is a setup.py script generated by py2applet

  Usage:
      python setup.py py2app
  """

  from setuptools import setup

  APP = ['t_sheep.py']
  DATA_FILES = []
  OPTIONS = {
      # 指定要打包的第三方库
      'includes': ['pygame'],
      # 指定APP里用到的图片，音效，文件等，
      # 可以指定文件夹，或是具体的文件
      # 指定文件夹就会把整个文件夹都打包
      # 这些内容如果放在上面的DATA_FILES里，也可以达到同等效果
      # 资源文件
      'resources': ['img'],
      # APP执行时显示的图标，icns是MAC图标的标准文件
    # 生成图标 https://www.jianshu.com/p/33df84bb52c2
      # 'iconfile': 'LOGO.icns',
      # 有待研究，暂时只设定了版本号
      'plist': {'CFBundleShortVersionsString': '0.1.0'},

      # 参考: https://py2app.readthedocs.io/en/latest/options.html#option-reference
  }

  setup(
      app=APP,
      data_files=DATA_FILES,
      options={'py2app': OPTIONS},
      setup_requires=['py2app'],
  )

MacOS生成应用图标可参考 :doc:`/docs/操作系统/Mac/图标制作`

例如::

  # 命令格式：sips -z 新图片宽度 新图片高度 原图片名 --out 临时.iconset/新图片完整名
  # 注意一定要以 icon_**.png或者icon_**@2x.png格式, 否则会失败
  sips -z 16 16 img.png --out tmp.iconset/icon_16x16.png
  sips -z 32 32 img.png --out tmp.iconset/icon_32x32.png
  sips -z 128 128 img.png --out tmp.iconset/icon_128x128.png
  sips -z 256 256 img.png --out tmp.iconset/icon_256x256.png

用.iconset生成.icns(MacOS用图标集合)::

  # 命令格式：iconutil -c icns 临时.iconset -o 名字.icns
  # 举个栗子：iconutil -c icns tmp.iconset -o logo.icns

这里可参考: `<https://blog.csdn.net/ypf1024/article/details/114011755>`_


















