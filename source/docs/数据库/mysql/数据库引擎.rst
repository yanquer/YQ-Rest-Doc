============================
数据库引擎
============================


.. post:: 2023-02-20 22:06:49
  :tags: mysql
  :category: 数据库
  :author: YanQue
  :location: CD
  :language: zh-cn


MyISAM引擎
  数据库表存储文件分成三类:

  - table_name.frm  表结构
  - table_name.MYI  表索引
  - table_name.MYD  表数据

  即索引文件和数据文件是分离的(非聚集)

  索引的叶子结点存储的是数据的地址

InnoDB
  数据库表存储文件分成两类:

  - table_name.frm  表结构 (8.0统一放到系统表的idb里面了貌似)
  - table_name.idb  表索引和数据

  即索引文件和数据文件是 **聚集** 的

  索引的叶子结点存储的是数据本身(聚集索引包含完整的数据记录)

  通常说的聚集索引就是指的这个 ``.idb``

  **非主键索引存储的是主键索引**, 为了保持一致性与节省空间.
  所以从非主键索引查询, 还是会回表查主键找数据.

一些常见问题
============================

为什么 InnoDB 建议必须建主键, 且建议使用整型的 **自增主键** ?
  以下原因:

  - InnoDB 会有一个聚集索引, 如果不建主键, 数据库自己也会维护一个不可见的主键列(叫row_id, 不然没法建B+树),
    因为不可见, 开发者自己也没法用, 所以还不如自己建
  - 使用自增主键, 主要是为了减小增加数据时候, 索引B+树会进行一个扩充,
    如果不是自增, 会有B+树插入的额外开销, 浪费数据库性能
  - 自增主键使用整型, 是因为比较是最快的且占空间较小. 如果是UUID, 每一位都要比







